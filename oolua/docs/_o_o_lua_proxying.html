<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>OOLua: Proxy</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="OOLua.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OOLua
   &#160;<span id="projectnumber">2.0.0.beta3</span>
   </div>
   <div id="projectbrief">C++ and Lua binding</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_o_o_lua_proxying.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Proxy </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="OOLuaProxyDSL"></a>
DSL</h1>
<p>The Domain specific language used for generating C++ bindings for Lua. OOLua provides a DSL for defining C++ types which are to be made available to a Lua script. The intention of this DSL is to hide the details whilst providing a simple and rememberable interface for performing the actions required. </p>
<dl class="section note"><dt>Note</dt><dd>"Optional" here means that extra macro parameters are optional, up to the configuration <a class="el" href="group___o_o_lua_file_generation.html#OOLuaConfigCppParams">max</a> for a specific operation. </dd></dl>
<p><a class="el" href="group___o_o_lua_minimalist.html">Minimalist</a> Generates a proxy function using the only the minimal of information which is generally the name of the thing being proxied and possibly a new name for the proxy. As with taking the address of any C++ function, if there is any ambiguity it will fail to compile, in which case a user should help the compiler by specifying more information using the matching, yet longer named <a class="el" href="group___o_o_lua_expressive.html">Expressive</a> DSL entry.<br/>
 The longer DSL name requires more information. <br/>
 </p>
<dl class="section note"><dt>Note</dt><dd>No <a class="el" href="group___o_o_lua_traits.html">Traits</a> can be expressed with this DSL group. </dd></dl>
<p><a class="el" href="group___o_o_lua_expressive.html">Expressive</a> Generates a function for which the user has expressed all the parameters for a function these may additionally have <a class="el" href="group___o_o_lua_traits.html">Traits</a>.</p>
<h1><a class="anchor" id="ClassProxy"></a>
Class Proxy</h1>
<p>Generating a proxy for a class normally takes place between two DSL procedures <a class="el" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd">OOLUA_PROXY</a> and <a class="el" href="group___o_o_lua_d_s_l.html#ga8dccd4d1893d0352a0f5e486c527c49e">OOLUA_PROXY_END</a> although alone these do not supply enough information for a proxy to be generated, the following shows the usage of the DSL to proxy and use a C++ class in Lua.</p>
<h2><a class="anchor" id="MinimalClassProxy"></a>
Minimal Class Proxy</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>Stub1 {};</div>
</div><!-- fragment --><p> To proxy a class and be able to use it in Lua requires a three part process. </p>
<h3><a class="anchor" id="ProxyBlock"></a>
Proxy Block</h3>
<p>Firstly you create a proxy block which starts with a OOLUA_PROXY call to which you pass the name of the C++ class to be proxied, this block ends at the next OOLUA_PROXY_END. Soon we will see how to proxy other aspects of a class in this block. </p>
<div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd" title="Starts the generation a proxy class. ">OOLUA_PROXY</a>(Stub1)</div>
<div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga8dccd4d1893d0352a0f5e486c527c49e" title="Ends the generation of the proxy class. ">OOLUA_PROXY_END</a></div>
</div><!-- fragment --> <h3><a class="anchor" id="ClassExporting"></a>
Exporting</h3>
<p>Secondly you export the member functions which are to be made available for the type in Lua. Exporting defines which member functions will be registered with Lua when the class type is registered. Even when there are no member functions to be exported you still need to inform OOLua about this. Calling an <a class="el" href="group___o_o_lua_exporting.html">OOLUA_EXPORT*</a> procedure in a header file is an error that will fail to compile.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___o_o_lua_exporting.html#ga6a15603355073c969178db64d32b8d07" title="Exports zero or more member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS</a> <br/>
 <a class="el" href="group___o_o_lua_exporting.html#ga8dbe5b8a090a86ade26f86d395c03fb0" title="Exports zero or more const member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS_CONST</a> <br/>
 <a class="el" href="group___o_o_lua_exporting.html#ga1df8f4cd9cdffef161de3c201d6b1a39" title="Inform that there are no functions of interest. ">OOLUA_EXPORT_NO_FUNCTIONS</a> </dd></dl>
<div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga1df8f4cd9cdffef161de3c201d6b1a39" title="Inform that there are no functions of interest. ">OOLUA_EXPORT_NO_FUNCTIONS</a>(Stub1)</div>
</div><!-- fragment --> <h3><a class="anchor" id="ClassRegistering"></a>
Registering</h3>
<p>Lastly we register the type with a <a class="el" href="structlua___state.html" title="Lua virtual machine. ">lua_State</a> after which the type can be <a class="el" href="_o_o_lua_proxying.html#DefaultConstructor">created</a> and used in Lua. </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> setUp()</div>
<div class="line">    {</div>
<div class="line">        m_lua = <span class="keyword">new</span> <a class="code" href="class_o_o_l_u_a_1_1_script.html" title="OOLua helper class. ">OOLUA::Script</a>;</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a870cd14a0757100bafcd5e4352894e83" title="Helper function. ">register_class</a>&lt;Stub1&gt;();</div>
<div class="line">    }</div>
</div><!-- fragment --> <div class="fragment"><div class="line">    <span class="keywordtype">void</span> new_luaCreatesInstance_noException()</div>
<div class="line">    {</div>
<div class="line">        CPPUNIT_ASSERT_NO_THROW(m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;Stub1.new()&quot;</span>));</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="ProxyTags"></a>
Tags</h2>
<p>Tags specifiy more information about the class which should be exposed, such as: </p>
<ul>
<li>Does the class support any operators? </li>
<li>Is it abstract ? </li>
<li>Does the class have enumerations? </li>
</ul>
<p><a class="el" href="group___o_o_lua_d_s_l.html#ga648dba626b4328aad9e995d4bb6391c2" title="Allows more information to be specified about the proxy class. ">OOLUA_TAGS(TagList)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TagList</td><td>Comma seperated list of <a class="el" href="group___o_o_lua_tags.html">Tags</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>An OOLUA_TAGS list without any <a class="el" href="group___o_o_lua_tags.html">Tags</a> entries is invalid. </dd></dl>
<h2><a class="anchor" id="DefaultConstructor"></a>
Default Constructor</h2>
<p>The default class constructor is a special member function like C++ and it will be implicitly defined for a type unless <a class="el" href="group___o_o_lua_tags.html">otherwise specified</a>. When available for a type "foo" in can be called in Lua using the following syntax. </p>
<div class="fragment"><div class="line">foo.new()</div>
</div><!-- fragment --> <dl class="section see"><dt>See Also</dt><dd><a class="el" href="struct_o_o_l_u_a_1_1_abstract.html" title="The class being mirrored is an abstract class. ">OOLUA::Abstract</a> <a class="el" href="struct_o_o_l_u_a_1_1_no__default__constructor.html" title="There is not a default constructor in the public interface yet there are other constructors. ">OOLUA::No_default_constructor</a> <a class="el" href="struct_o_o_l_u_a_1_1_no__public__constructors.html" title="There are no constructors in the public interface. ">OOLUA::No_public_constructors</a></dd></dl>
<h2><a class="anchor" id="ClassConstructors"></a>
Constructors</h2>
<p><a class="el" href="group___o_o_lua_d_s_l.html#ga1f118192493f759ce94b47470f9075bb" title="Creates a block into which none default constructors can be defined with OOLUA_CTOR. ">OOLUA_CTORS(ConstructorEntriesList)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ConstructorEntriesList</td><td>List of <a class="el" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc">OOLUA_CTOR</a> </td></tr>
  </table>
  </dd>
</dl>
<p>To enable the construction of an instance which is a specific type, there must be constructor(s) for that type registered with OOLua. <a class="el" href="group___o_o_lua_d_s_l.html#ga1f118192493f759ce94b47470f9075bb">OOLUA_CTORS</a> is the block into which you can define none default constructor entries using <a class="el" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc">OOLUA_CTOR</a>. </p>
<p>Constructors are the only real type of overloading which is permitted by OOLua and there is an important point which should be noted. OOLua will try and match the number of parameters on the stack with the amount required by each OOLUA_CTOR entry and will look in the order they were defined. When interacting with the Lua stack certain types can not be differentiated between, these include some integral types such as float, int, double etc and types which are of a proxy class type or derived from that type. OOLua implicitly converts between classes in a hierarchy even if a reference is required. This means for example that if there are constructors such as Foo::Foo(int) and Foo::Foo(float) it will depend on which was defined first in the OOLUA_CTORS block as to which will be invoked for a call such as Foo.new(1).</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="struct_o_o_l_u_a_1_1_no__default__constructor.html">No_default_constructor</a> </dd></dl>
<dl class="section note"><dt>Note</dt><dd>An OOLUA_CTORS block without any <a class="el" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc">OOLUA_CTOR</a> entries is invalid. </dd></dl>
<div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd" title="Starts the generation a proxy class. ">OOLUA_PROXY</a>(ParamConstructor)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga648dba626b4328aad9e995d4bb6391c2" title="Allows more information to be specified about the proxy class. ">OOLUA_TAGS</a>(</div>
<div class="line">        No_default_constructor</div>
<div class="line">    )</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga1f118192493f759ce94b47470f9075bb" title="Creates a block into which none default constructors can be defined with OOLUA_CTOR. ">OOLUA_CTORS</a>(</div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(<span class="keywordtype">bool</span>) <span class="comment">/*NOLINT(readability/casting)*/</span></div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(<span class="keywordtype">int</span>) <span class="comment">/*NOLINT(readability/casting)*/</span></div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(<span class="keywordtype">char</span> const*)</div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(<span class="keywordtype">int</span>, <span class="keywordtype">bool</span>)</div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(Stub1 *) <span class="comment">/*NOLINT(readability/casting)*/</span></div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(Stub1 *, <a class="code" href="struct_stub2.html">Stub2</a>*)</div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(<a class="code" href="struct_stub2.html">Stub2</a>)</div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(Stub3*) <span class="comment">/*NOLINT(readability/casting)*/</span></div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(Stub3 const *)</div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(OOLUA::Lua_func_ref)</div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(OOLUA::Table)</div>
<div class="line">    )</div>
<div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga8dccd4d1893d0352a0f5e486c527c49e" title="Ends the generation of the proxy class. ">OOLUA_PROXY_END</a></div>
</div><!-- fragment --> <h2><a class="anchor" id="ExposingMemberFunctions"></a>
Exposing Member Functions</h2>
<p><a class="el" href="group___o_o_lua_minimalist.html#ga3c1cca539f85a5728c9896d54ea4e275" title="Deduce and generate a proxy for a member function. ">OOLUA_MFUNC(FunctionName, Optional)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FunctionName</td><td>Name of the member function to be proxied </td></tr>
    <tr><td class="paramname">Optional</td><td>ProxyFunctionName. Defaults to FunctionName </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___o_o_lua_file_generation.html#OOLuaConfigCppParams">cpp_params</a> <br/>
 <a class="el" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9">OOLUA_MEM_FUNC</a> <br/>
 <a class="el" href="group___o_o_lua_expressive.html#ga263ff9ad508c44c25b2c09283831f8a4">OOLUA_MEM_FUNC_RENAME</a> </dd></dl>
<p><a class="el" href="group___o_o_lua_minimalist.html#gad46e27f9cb000653ce7266fb98c6d062" title="Deduce and generate a proxy for a constant member function. ">OOLUA_MFUNC_CONST(FunctionName, Optional)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FunctionName</td><td>Name of the constant function to be proxied </td></tr>
    <tr><td class="paramname">Optional</td><td>ProxyFunctionName. Defaults to FunctionName </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___o_o_lua_file_generation.html#OOLuaConfigCppParams">cpp_params</a> <br/>
 <a class="el" href="group___o_o_lua_expressive.html#gad07aac0fab6d7884001bcf94debde2ed">OOLUA_MEM_FUNC_CONST</a> <br/>
 <a class="el" href="group___o_o_lua_expressive.html#gaf7c3e0c1f8ca5c56a0ba30053f8359d4">OOLUA_MEM_FUNC_CONST_RENAME</a> </dd></dl>
<div class="fragment"><div class="line"><span class="comment">//typedef the type of vector into the global namespace</span></div>
<div class="line"><span class="comment">//This is required as a vector has more than one template type</span></div>
<div class="line"><span class="comment">//and the commas in the template confuse a macro.</span></div>
<div class="line"><span class="keyword">typedef</span> std::vector&lt;int&gt; vector_int;</div>
<div class="line"></div>
<div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd" title="Starts the generation a proxy class. ">OOLUA_PROXY</a>(vector_int)</div>
<div class="line">    <span class="comment">//C++11 adds an overload</span></div>
<div class="line">    <span class="comment">//OOLUA_MFUNC(push_back)</span></div>
<div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9" title="Generates a member function proxy which will also be the named FunctionName. ">OOLUA_MEM_FUNC</a>(<span class="keywordtype">void</span>, push_back, class_::const_reference)</div>
<div class="line">    <a class="code" href="group___o_o_lua_minimalist.html#ga3c1cca539f85a5728c9896d54ea4e275" title="Deduce and generate a proxy for a member function. ">OOLUA_MFUNC</a>(pop_back)</div>
<div class="line">    <a class="code" href="group___o_o_lua_minimalist.html#gad46e27f9cb000653ce7266fb98c6d062" title="Deduce and generate a proxy for a constant member function. ">OOLUA_MFUNC_CONST</a>(size)</div>
<div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga8dccd4d1893d0352a0f5e486c527c49e" title="Ends the generation of the proxy class. ">OOLUA_PROXY_END</a></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga6a15603355073c969178db64d32b8d07" title="Exports zero or more member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS</a>(vector_int, push_back, pop_back)</div>
<div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga8dbe5b8a090a86ade26f86d395c03fb0" title="Exports zero or more const member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS_CONST</a>(vector_int, size)</div>
</div><!-- fragment --> <h2><a class="anchor" id="AbstractClass"></a>
Abstract Class</h2>
<p>Generating an abstract proxy requires that you specify the <a class="el" href="struct_o_o_l_u_a_1_1_abstract.html">Abstract</a> tag in the <a class="el" href="group___o_o_lua_d_s_l.html#ga648dba626b4328aad9e995d4bb6391c2">OOLUA_TAGS</a> block When OOLua encounters the <a class="el" href="struct_o_o_l_u_a_1_1_abstract.html">Abstract</a> tag it will not look for any constructors for the type and the type will not be constructable from Lua. Specifying an <a class="el" href="group___o_o_lua_d_s_l.html#ga1f118192493f759ce94b47470f9075bb">OOLUA_CTORS</a> block will have no effect and such a block will be ignored. </p>
<div class="fragment"><div class="line"><span class="keyword">class </span>Abstract1</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> ~Abstract1(){}</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> func1()=0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> virtualVoidParam3Int(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>) = 0;</div>
<div class="line">};</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd" title="Starts the generation a proxy class. ">OOLUA_PROXY</a>(Abstract1)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga648dba626b4328aad9e995d4bb6391c2" title="Allows more information to be specified about the proxy class. ">OOLUA_TAGS</a>(Abstract)</div>
<div class="line">    <a class="code" href="group___o_o_lua_minimalist.html#ga3c1cca539f85a5728c9896d54ea4e275" title="Deduce and generate a proxy for a member function. ">OOLUA_MFUNC</a>(virtualVoidParam3Int)</div>
<div class="line">    <a class="code" href="group___o_o_lua_minimalist.html#ga3c1cca539f85a5728c9896d54ea4e275" title="Deduce and generate a proxy for a member function. ">OOLUA_MFUNC</a>(func1)</div>
<div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga8dccd4d1893d0352a0f5e486c527c49e" title="Ends the generation of the proxy class. ">OOLUA_PROXY_END</a></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga6a15603355073c969178db64d32b8d07" title="Exports zero or more member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS</a>(Abstract1, func1, virtualVoidParam3Int)</div>
<div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga8dbe5b8a090a86ade26f86d395c03fb0" title="Exports zero or more const member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS_CONST</a>(Abstract1)</div>
</div><!-- fragment --> <h2><a class="anchor" id="BaseClass"></a>
Base Classes</h2>
<p>Using <a class="el" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd">OOLUA_PROXY's</a> optional parameter(s) specifies base class(es) for the proxy <a class="el" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd" title="Starts the generation a proxy class. ">OOLUA_PROXY(ClassName, Optional)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ClassName</td><td>Class to be proxied </td></tr>
    <tr><td class="paramname">Optional</td><td>Comma seperated list of real base classes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>Each class specified in Optional must be a real base class of ClassName </dd></dl>
<div class="fragment"><div class="line"><span class="keyword">class </span>Derived1Abstract1 : <span class="keyword">public</span> Abstract1</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> ~Derived1Abstract1(){}</div>
<div class="line">    MOCK_METHOD0(func1, <span class="keywordtype">void</span>());</div>
<div class="line">    MOCK_METHOD3(virtualVoidParam3Int, <span class="keywordtype">void</span>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>));</div>
<div class="line">};</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd" title="Starts the generation a proxy class. ">OOLUA_PROXY</a>(Derived1Abstract1, Abstract1)</div>
<div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga8dccd4d1893d0352a0f5e486c527c49e" title="Ends the generation of the proxy class. ">OOLUA_PROXY_END</a></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga6a15603355073c969178db64d32b8d07" title="Exports zero or more member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS</a>(Derived1Abstract1)</div>
<div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga8dbe5b8a090a86ade26f86d395c03fb0" title="Exports zero or more const member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS_CONST</a>(Derived1Abstract1)</div>
</div><!-- fragment --> <h2><a class="anchor" id="ClassOps"></a>
Operators</h2>
<p><a class="el" href="group___operator_tags.html">Operator Tags</a> inform OOLua that a class exposes one or more of the operators supported: </p>
<ul>
<li><a class="el" href="struct_o_o_l_u_a_1_1_less__op.html">Less_op</a> </li>
<li><a class="el" href="struct_o_o_l_u_a_1_1_equal__op.html">Equal_op</a> </li>
<li><a class="el" href="struct_o_o_l_u_a_1_1_not__equal__op.html">Not_equal_op</a> </li>
<li><a class="el" href="struct_o_o_l_u_a_1_1_less__equal__op.html">Less_equal_op</a> </li>
<li><a class="el" href="struct_o_o_l_u_a_1_1_div__op.html">Div_op</a> </li>
<li><a class="el" href="struct_o_o_l_u_a_1_1_mul__op.html">Mul_op</a> </li>
<li><a class="el" href="struct_o_o_l_u_a_1_1_sub__op.html">Sub_op</a> </li>
<li><a class="el" href="struct_o_o_l_u_a_1_1_add__op.html">Add_op</a> </li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">class </span>Class_ops</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    Class_ops(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp; i):m_i(i){}</div>
<div class="line">    Class_ops():m_i(0){}</div>
<div class="line">    Class_ops(Class_ops <span class="keyword">const</span>&amp; rhs)</div>
<div class="line">        :m_i(rhs.m_i)</div>
<div class="line">    {}</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> <span class="keyword">const</span>&amp; geti()<span class="keyword">const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> m_i;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">bool</span> operator == (Class_ops <span class="keyword">const</span>&amp; rhs)<span class="keyword">const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> m_i == rhs.m_i;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">bool</span> operator &lt; (Class_ops <span class="keyword">const</span>&amp; rhs)<span class="keyword">const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> m_i &lt; rhs.m_i;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">bool</span> operator &lt;= (Class_ops <span class="keyword">const</span>&amp; rhs)<span class="keyword">const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> m_i &lt;= rhs.m_i;</div>
<div class="line">    }</div>
<div class="line">    Class_ops operator + (Class_ops <span class="keyword">const</span>&amp; rhs)<span class="keyword">const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> Class_ops( m_i + rhs.m_i );</div>
<div class="line">    }</div>
<div class="line">    Class_ops operator * (Class_ops <span class="keyword">const</span>&amp; rhs)<span class="keyword">const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> Class_ops(m_i * rhs.m_i);</div>
<div class="line">    }</div>
<div class="line">    Class_ops operator - (Class_ops <span class="keyword">const</span>&amp; rhs)<span class="keyword">const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> Class_ops(m_i - rhs.m_i);</div>
<div class="line">    }</div>
<div class="line">    Class_ops operator / (Class_ops <span class="keyword">const</span>&amp; rhs)<span class="keyword">const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> Class_ops(m_i / rhs.m_i);</div>
<div class="line">    }</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">int</span> m_i;</div>
<div class="line">};</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd" title="Starts the generation a proxy class. ">OOLUA_PROXY</a>(Class_ops)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga648dba626b4328aad9e995d4bb6391c2" title="Allows more information to be specified about the proxy class. ">OOLUA_TAGS</a>(</div>
<div class="line">        Equal_op</div>
<div class="line">        , Less_op</div>
<div class="line">        , Less_equal_op</div>
<div class="line">        , Add_op</div>
<div class="line">        , Sub_op</div>
<div class="line">        , Mul_op</div>
<div class="line">        , Div_op</div>
<div class="line">    )</div>
<div class="line">    <a class="code" href="group___o_o_lua_minimalist.html#gad46e27f9cb000653ce7266fb98c6d062" title="Deduce and generate a proxy for a constant member function. ">OOLUA_MFUNC_CONST</a>(geti)</div>
<div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga8dccd4d1893d0352a0f5e486c527c49e" title="Ends the generation of the proxy class. ">OOLUA_PROXY_END</a></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga6a15603355073c969178db64d32b8d07" title="Exports zero or more member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS</a>(Class_ops)</div>
<div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga8dbe5b8a090a86ade26f86d395c03fb0" title="Exports zero or more const member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS_CONST</a>(Class_ops, geti)</div>
</div><!-- fragment --> <h2><a class="anchor" id="ClassPublicMembers"></a>
Public Members</h2>
<p><a class="el" href="group___o_o_lua_d_s_l.html#ga2d7fbe299f29dd902793492cda104b10" title="Generates a getter, which is a constant function, to retreive a public instance. ">OOLUA_MGET(PublicName, Optional)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PublicName</td><td>Name of the public variable to be proxied. </td></tr>
    <tr><td class="paramname">Optional</td><td>GetterName. Defaults to get_PublicName </td></tr>
  </table>
  </dd>
</dl>
<p><a class="el" href="group___o_o_lua_d_s_l.html#gae55dc0c8bf10c7ea99066a451715f2a7" title="Generates a setter, which is a none constant function, to set the public instance. ">OOLUA_MSET(PublicName, Optional)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PublicName</td><td>Name of the public variable to be proxied. </td></tr>
    <tr><td class="paramname">Optional</td><td>SetterName. Defaults to set_PublicName </td></tr>
  </table>
  </dd>
</dl>
<p><a class="el" href="group___o_o_lua_d_s_l.html#ga46dd439b6a271346416ddaa8b748cad4" title="Generates a getter and setter for a public instance. ">OOLUA_MGET_MSET(PublicName, Optional1, Optional2)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PublicName</td><td>Name of the public variable to be proxied. </td></tr>
    <tr><td class="paramname">Optional1</td><td>GetterName. Defaults to get_PublicName </td></tr>
    <tr><td class="paramname">Optional2</td><td>SetterName. Defaults to set_PublicName </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___o_o_lua_d_s_l.html#ga2d7fbe299f29dd902793492cda104b10" title="Generates a getter, which is a constant function, to retreive a public instance. ">OOLUA_MGET</a> and <a class="el" href="group___o_o_lua_d_s_l.html#gae55dc0c8bf10c7ea99066a451715f2a7" title="Generates a setter, which is a none constant function, to set the public instance. ">OOLUA_MSET</a> </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If one optional parameter is supplied then both must be given. </dd></dl>
<div class="fragment"><div class="line"><span class="keyword">class </span>Public_variables</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    Public_variables();</div>
<div class="line">    ~Public_variables();</div>
<div class="line">    <span class="keywordtype">int</span> an_int;</div>
<div class="line">    <span class="keywordtype">int</span> m_int;</div>
<div class="line">    <span class="keywordtype">int</span>* int_ptr;</div>
<div class="line">    Stub1* dummy_instance;</div>
<div class="line">    Stub1 dummy_instance_none_ptr;</div>
<div class="line">    Stub1&amp; dummy_ref;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> set_value = 1;</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> initial_value = 0;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    Public_variables(Public_variables <span class="keyword">const</span>&amp;);</div>
<div class="line">    Public_variables&amp; operator = (Public_variables <span class="keyword">const</span>&amp;);</div>
<div class="line">};</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd" title="Starts the generation a proxy class. ">OOLUA_PROXY</a>(Public_variables)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga46dd439b6a271346416ddaa8b748cad4" title="Generates a getter and setter for a public instance. ">OOLUA_MGET_MSET</a>(an_int)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga46dd439b6a271346416ddaa8b748cad4" title="Generates a getter and setter for a public instance. ">OOLUA_MGET_MSET</a>(int_ptr, get_int_ptr, set_int_ptr)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga46dd439b6a271346416ddaa8b748cad4" title="Generates a getter and setter for a public instance. ">OOLUA_MGET_MSET</a>(dummy_instance)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga2d7fbe299f29dd902793492cda104b10" title="Generates a getter, which is a constant function, to retreive a public instance. ">OOLUA_MGET</a>(dummy_ref)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga2d7fbe299f29dd902793492cda104b10" title="Generates a getter, which is a constant function, to retreive a public instance. ">OOLUA_MGET</a>(dummy_instance_none_ptr)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga2d7fbe299f29dd902793492cda104b10" title="Generates a getter, which is a constant function, to retreive a public instance. ">OOLUA_MGET</a>(m_int, get_int)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga2d7fbe299f29dd902793492cda104b10" title="Generates a getter, which is a constant function, to retreive a public instance. ">OOLUA_MGET</a>(m_int)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#gae55dc0c8bf10c7ea99066a451715f2a7" title="Generates a setter, which is a none constant function, to set the public instance. ">OOLUA_MSET</a>(m_int, set_int)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#gae55dc0c8bf10c7ea99066a451715f2a7" title="Generates a setter, which is a none constant function, to set the public instance. ">OOLUA_MSET</a>(m_int)</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga8dccd4d1893d0352a0f5e486c527c49e" title="Ends the generation of the proxy class. ">OOLUA_PROXY_END</a></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga6a15603355073c969178db64d32b8d07" title="Exports zero or more member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS</a>(Public_variables</div>
<div class="line">                                , set_an_int</div>
<div class="line">                                , set_int_ptr</div>
<div class="line">                                , set_dummy_instance</div>
<div class="line">                                , set_m_int</div>
<div class="line">                                , set_int)</div>
<div class="line"></div>
<div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga8dbe5b8a090a86ade26f86d395c03fb0" title="Exports zero or more const member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS_CONST</a>(Public_variables</div>
<div class="line">                            , get_an_int</div>
<div class="line">                            , get_int_ptr</div>
<div class="line">                            , get_dummy_instance</div>
<div class="line">                            , get_dummy_ref</div>
<div class="line">                            , get_dummy_instance_none_ptr</div>
<div class="line">                            , get_int</div>
<div class="line">                            , get_m_int)</div>
</div><!-- fragment --> <p><b>Public member access in Lua is via a member function</b> </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> getAnInt_publicVariablesClassPassedToLua_returnsSetValue()</div>
<div class="line">    {</div>
<div class="line">        m_class_with_public_vars-&gt;an_int = Public_variables::set_value;</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;func = function(obj) return obj:get_an_int() end&quot;</span>);</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(<span class="stringliteral">&quot;func&quot;</span>, m_class_with_public_vars);</div>
<div class="line">        <span class="keywordtype">int</span> result;</div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a16e0b11358d3e36facfdf294eab8f1b7" title="Pulls the top element off the stack and pops it. ">OOLUA::pull</a>(*m_lua, result);</div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(Public_variables::set_value, result);</div>
<div class="line">    }</div>
</div><!-- fragment --><h2><a class="anchor" id="ClassEnumerations"></a>
Enumerations</h2>
<p><a class="el" href="group___o_o_lua_d_s_l.html#ga794911527043d10c8d7a142d56d64673" title="Creates a block into which enumerators can be defined with OOLUA_ENUM. ">OOLUA_ENUMS(EnumEntriesList)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EnumEntriesList</td><td>List of <a class="el" href="group___o_o_lua_d_s_l.html#gad8fa42b0c1d1c9a67302c255287412fd">OOLUA_ENUM</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>An OOLUA_ENUMS block without any <a class="el" href="group___o_o_lua_d_s_l.html#gad8fa42b0c1d1c9a67302c255287412fd">OOLUA_ENUM</a> entries is invalid. </dd></dl>
<p><a class="el" href="group___o_o_lua_d_s_l.html#gad8fa42b0c1d1c9a67302c255287412fd" title="Creates a entry into a OOLUA_ENUMS block. ">OOLUA_ENUM(EnumName)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EnumName</td><td>The class enumeration name </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="keyword">class </span>Enums</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">enum</span> COLOUR{GREEN = 0, INVALID};</div>
<div class="line">    Enums()</div>
<div class="line">        :m_enum(INVALID)</div>
<div class="line">    {}</div>
<div class="line">    Enums(COLOUR e)</div>
<div class="line">        :m_enum(e)</div>
<div class="line">    {}</div>
<div class="line">    COLOUR m_enum;</div>
<div class="line">    <span class="keywordtype">void</span> set_enum(COLOUR e)</div>
<div class="line">    {</div>
<div class="line">        m_enum = e;</div>
<div class="line">    }</div>
<div class="line">    COLOUR get_enum()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> m_enum;</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd" title="Starts the generation a proxy class. ">OOLUA_PROXY</a>(Enums)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga648dba626b4328aad9e995d4bb6391c2" title="Allows more information to be specified about the proxy class. ">OOLUA_TAGS</a>(</div>
<div class="line">        Register_class_enums</div>
<div class="line">    )</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga1f118192493f759ce94b47470f9075bb" title="Creates a block into which none default constructors can be defined with OOLUA_CTOR. ">OOLUA_CTORS</a>(</div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#ga437d72d20968100efe9fb362247176cc" title="Generates a constructor in a constructor block. ">OOLUA_CTOR</a>(Enums::COLOUR)</div>
<div class="line">    )</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga794911527043d10c8d7a142d56d64673" title="Creates a block into which enumerators can be defined with OOLUA_ENUM. ">OOLUA_ENUMS</a>(</div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#gad8fa42b0c1d1c9a67302c255287412fd" title="Creates a entry into a OOLUA_ENUMS block. ">OOLUA_ENUM</a>(GREEN)</div>
<div class="line">        <a class="code" href="group___o_o_lua_d_s_l.html#gad8fa42b0c1d1c9a67302c255287412fd" title="Creates a entry into a OOLUA_ENUMS block. ">OOLUA_ENUM</a>(INVALID)</div>
<div class="line">    )</div>
<div class="line">    <a class="code" href="group___o_o_lua_minimalist.html#ga3c1cca539f85a5728c9896d54ea4e275" title="Deduce and generate a proxy for a member function. ">OOLUA_MFUNC</a>(set_enum)</div>
<div class="line">    <a class="code" href="group___o_o_lua_minimalist.html#ga3c1cca539f85a5728c9896d54ea4e275" title="Deduce and generate a proxy for a member function. ">OOLUA_MFUNC</a>(get_enum)</div>
<div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga8dccd4d1893d0352a0f5e486c527c49e" title="Ends the generation of the proxy class. ">OOLUA_PROXY_END</a></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga8dbe5b8a090a86ade26f86d395c03fb0" title="Exports zero or more const member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS_CONST</a>(Enums)</div>
<div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga6a15603355073c969178db64d32b8d07" title="Exports zero or more member functions which will be registered with Lua. ">OOLUA_EXPORT_FUNCTIONS</a>(Enums</div>
<div class="line">                        , set_enum</div>
<div class="line">                        , get_enum)</div>
</div><!-- fragment --> <div class="fragment"><div class="line">    <span class="keywordtype">void</span> constructWithEnum_passedValueGreen_functionReturnsGreen()</div>
<div class="line">    {</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a870cd14a0757100bafcd5e4352894e83" title="Helper function. ">register_class</a>&lt;Enums&gt;();</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;foo = function() &quot;</span></div>
<div class="line">                            <span class="stringliteral">&quot;local obj = Enums.new(Enums.GREEN) &quot;</span></div>
<div class="line">                            <span class="stringliteral">&quot;return obj:get_enum() &quot;</span></div>
<div class="line">                         <span class="stringliteral">&quot;end&quot;</span>);</div>
<div class="line">        Enums::COLOUR result(Enums::INVALID);</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(<span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a16e0b11358d3e36facfdf294eab8f1b7" title="Pulls the top element off the stack and pops it. ">OOLUA::pull</a>(*m_lua, result);</div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(Enums::GREEN, result);</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="ClassStaticFunctions"></a>
Static Functions</h2>
<p><a class="el" href="group___o_o_lua_minimalist.html#ga8ce05f53d7da2b3c2226f03002fa75db" title="Deduce and generate a proxy for a class static function. ">OOLUA_SFUNC(FunctionName, Optional)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FunctionName</td><td>Name of the static function to be proxied </td></tr>
    <tr><td class="paramname">Optional</td><td>ProxyFunctionName. Defaults to FunctionName </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function will not be exported and needs to be registered with OOLua see <a class="el" href="namespace_o_o_l_u_a.html#a108fecb5fb740b6f7b0968afbff9683c" title="Registers a key K and value V entry into class T. ">OOLUA::register_class_static</a> </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___o_o_lua_file_generation.html#OOLuaConfigCppParams">cpp_params</a> </dd></dl>
<div class="fragment"><div class="line"><span class="keyword">class </span>ClassHasStaticFunction</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> static_function(){}</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> static_function(<span class="keywordtype">int</span> <span class="comment">/*DontCare*/</span>){}</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">int</span> returns_input(<span class="keywordtype">int</span> t){<span class="keywordflow">return</span> t;}</div>
<div class="line">};</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd" title="Starts the generation a proxy class. ">OOLUA_PROXY</a>(ClassHasStaticFunction)</div>
<div class="line">    <a class="code" href="group___o_o_lua_d_s_l.html#ga648dba626b4328aad9e995d4bb6391c2" title="Allows more information to be specified about the proxy class. ">OOLUA_TAGS</a>(No_public_constructors)</div>
<div class="line">    <a class="code" href="group___o_o_lua_minimalist.html#ga8ce05f53d7da2b3c2226f03002fa75db" title="Deduce and generate a proxy for a class static function. ">OOLUA_SFUNC</a>(returns_input)</div>
<div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga8dccd4d1893d0352a0f5e486c527c49e" title="Ends the generation of the proxy class. ">OOLUA_PROXY_END</a></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_exporting.html#ga1df8f4cd9cdffef161de3c201d6b1a39" title="Inform that there are no functions of interest. ">OOLUA_EXPORT_NO_FUNCTIONS</a>(ClassHasStaticFunction)</div>
</div><!-- fragment --><h1><a class="anchor" id="CFunctions"></a>
C Functions</h1>
<h2><a class="anchor" id="CFunctionMinimalist"></a>
Minimalist</h2>
<p>We have already seen the <a class="el" href="group___o_o_lua_minimalist.html">Minimalist</a> version in the Hello Moon example.<br/>
 Deduce and generate a proxy for a C function. <br/>
 <a class="el" href="group___o_o_lua_minimalist.html#gadb95e992a32ab9c2a76683c3c628ea6c" title="Deduce and generate a proxy for a C function. ">OOLUA_CFUNC(FunctionName, ProxyFunctionName)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FunctionName</td><td>Name of the C function to be proxied </td></tr>
    <tr><td class="paramname">ProxyFunctionName</td><td>Name of the function to generate which will proxy FunctionName </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___o_o_lua_file_generation.html#OOLuaConfigCppParams">cpp_params</a> <br/>
 <a class="el" href="group___o_o_lua_expressive.html#ga6106a47cfaeb591d83d9b444a3f95918">OOLUA_C_FUNCTION</a> </dd></dl>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> say(<span class="keywordtype">char</span> <span class="keyword">const</span>* input)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s from a standalone function\n&quot;</span>, input);</div>
<div class="line">}</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_minimalist.html#gadb95e992a32ab9c2a76683c3c628ea6c" title="Deduce and generate a proxy for a C function. ">OOLUA_CFUNC</a>(say, l_say)</div>
</div><!-- fragment --> <div class="fragment"><div class="line">    <span class="keywordtype">void</span> hello_minimalist_function()</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">using namespace </span>OOLUA; <span class="comment">//NOLINT(build/namespaces)</span></div>
<div class="line">        <a class="code" href="class_o_o_l_u_a_1_1_script.html" title="OOLua helper class. ">Script</a> vm;</div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a5c71578a7840357f3ac1b0f7256e514e" title="Helper function to set a Lua global variable. ">set_global</a>(vm, <span class="stringliteral">&quot;say&quot;</span>, l_say);</div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a72bc986a38cc2c78d57184f6fe9f9109" title="Loads and runs a chunk of code. ">run_chunk</a>(vm, <span class="stringliteral">&quot;say(&#39;Hello Lua&#39;)&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="CFunctionExpressive"></a>
Expressive</h2>
<p>Generates a block which will call the C function FunctionName. <br/>
 <a class="el" href="group___o_o_lua_expressive.html#ga6106a47cfaeb591d83d9b444a3f95918" title="Generates a block which will call the C function FunctionName. ">OOLUA_C_FUNCTION(FunctionReturnType,FunctionName, Optional)</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FunctionReturnType</td><td></td></tr>
    <tr><td class="paramname">FunctionName</td><td></td></tr>
    <tr><td class="paramname">Optional</td><td>Comma seperated list of function parameter types </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___o_o_lua_file_generation.html#OOLuaConfigCppParams">cpp_params</a> </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>The function in which this macro is contained must declare a <a class="el" href="structlua___state.html" title="Lua virtual machine. ">lua_State</a> pointer which can be identified by the name "vm" <div class="fragment"><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> foo(<span class="keywordtype">int</span>);</div>
<div class="line"><span class="keywordtype">int</span> l_foo(<a class="code" href="structlua___state.html" title="Lua virtual machine. ">lua_State</a>* vm)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga6106a47cfaeb591d83d9b444a3f95918" title="Generates a block which will call the C function FunctionName. ">OOLUA_C_FUNCTION</a>(<span class="keywordtype">void</span>,foo,<span class="keywordtype">int</span>)</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>
<dl class="section note"><dt>Note</dt><dd>This macro should ideally be used as the last operation of a function body as control will return to the caller. Notice there is no return statement in l_foo </dd></dl>
<p>In the following example we have a C function which is overloaded, we can use the <a class="el" href="group___o_o_lua_expressive.html">Expressive</a> DSL here in which we supply the return and parameter types. The function will then be resolved to the correct overload. </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> expressive_say(<span class="keywordtype">char</span> <span class="keyword">const</span>* input)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s from a expressive function\n&quot;</span>, input);</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> expressive_say(<span class="keywordtype">int</span> input)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;Huh %d\n&quot;</span>, input);</div>
<div class="line">    CPPUNIT_ASSERT(0);</div>
<div class="line">}</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="keywordtype">int</span> expressive_lsay(<a class="code" href="structlua___state.html" title="Lua virtual machine. ">lua_State</a>* vm)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga6106a47cfaeb591d83d9b444a3f95918" title="Generates a block which will call the C function FunctionName. ">OOLUA_C_FUNCTION</a>(<span class="keywordtype">void</span>, expressive_say, <span class="keywordtype">char</span> <span class="keyword">const</span>*)</div>
<div class="line">}</div>
</div><!-- fragment --> <div class="fragment"><div class="line">    <span class="keywordtype">void</span> hello_expressive_function()</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">using namespace </span>OOLUA; <span class="comment">//NOLINT(build/namespaces)</span></div>
<div class="line">        <a class="code" href="class_o_o_l_u_a_1_1_script.html" title="OOLua helper class. ">Script</a> vm;</div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a5c71578a7840357f3ac1b0f7256e514e" title="Helper function to set a Lua global variable. ">set_global</a>(vm, <span class="stringliteral">&quot;say&quot;</span>, expressive_lsay);</div>
<div class="line">        vm.run_chunk(<span class="stringliteral">&quot;say(&#39;Hello Lua&#39;)&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="CFunctionMinimalistAnother"></a>
Overloaded Minimalist</h2>
<p>You may have noticed that we did not apply any <a class="el" href="group___o_o_lua_traits.html">Traits</a> for the <a class="el" href="_o_o_lua_proxying.html#CFunctionExpressive">Expressive C version</a>, so maybe it would be nice if we could do it another way; well that all depends on what you consider nice! The function can not be resolved unless we give the compiler more information, but in this case it does not mean we have to use the <a class="el" href="group___o_o_lua_expressive.html">Expressive</a> DSL. We can instead cast the function pointer, note that a stand alone function name is a function pointer, to the wanted type and therefore resolve to the correct function overload whilst still using the <a class="el" href="group___o_o_lua_minimalist.html">Minimalist</a> DSL </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> expressive_say(<span class="keywordtype">char</span> <span class="keyword">const</span>* input)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s from a expressive function\n&quot;</span>, input);</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> expressive_say(<span class="keywordtype">int</span> input)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;Huh %d\n&quot;</span>, input);</div>
<div class="line">    CPPUNIT_ASSERT(0);</div>
<div class="line">}</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_minimalist.html#gadb95e992a32ab9c2a76683c3c628ea6c" title="Deduce and generate a proxy for a C function. ">OOLUA_CFUNC</a>( (( <span class="keywordtype">void</span>(*)(<span class="keywordtype">char</span> <span class="keyword">const</span>*))expressive_say), cast_expressive_say)</div>
</div><!-- fragment --> <div class="fragment"><div class="line">    <span class="keywordtype">void</span> hello_cast_minimalist_function()</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">using namespace </span>OOLUA; <span class="comment">//NOLINT(build/namespaces)</span></div>
<div class="line">        <a class="code" href="class_o_o_l_u_a_1_1_script.html" title="OOLua helper class. ">Script</a> vm;</div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a5c71578a7840357f3ac1b0f7256e514e" title="Helper function to set a Lua global variable. ">set_global</a>(vm, <span class="stringliteral">&quot;say&quot;</span>, cast_expressive_say);</div>
<div class="line">        vm.run_chunk(<span class="stringliteral">&quot;say(&#39;Hello Lua, we are a cast function not&#39;)&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><h1><a class="anchor" id="OOLuaProxyTraitsDoc"></a>
Traits</h1>
<p>Provides direction and/or ownership information. </p>
<p>The general naming convention for traits is:<br/>
 </p>
<ul>
<li><a class="el" href="group___o_o_lua_function_param_traits.html">Parameter Traits</a> : end in "_p" </li>
<li><a class="el" href="group___o_o_lua_function_return_traits.html">Function Return Traits</a> : end in "_return" or "_null" </li>
<li><a class="el" href="group___o_o_lua_stack_traits.html">Stack Traits</a> : end in "_ptr". </li>
</ul>
<h2><a class="anchor" id="OOLuaParamTraits"></a>
Parameter Traits</h2>
<p>DSL Traits for function parameter types. </p>
<p>Traits which allow control of ownership include in their name either "lua" or "cpp"; directional traits contain "in", "out" or a combination. </p>
<h3><a class="anchor" id="OOLuaTraitInDoc"></a>
in_p</h3>
<p>The calling Lua procedure supplies the parameter to the proxied function. No change of ownership occurs. </p>
<dl class="section note"><dt>Note</dt><dd>This is the default trait used for function parameters when no trait is supplied. </dd></dl>
<p>Member Function: </p>
<div class="fragment"><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> refPtrConst(ParamType <span class="keyword">const</span>* &amp; instance) = 0;</div>
</div><!-- fragment --><p> Proxy Function: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_minimalist.html#ga3c1cca539f85a5728c9896d54ea4e275" title="Deduce and generate a proxy for a member function. ">OOLUA_MFUNC</a>(refPtrConst)</div>
</div><!-- fragment --><p> Usage: </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> inTraitConst_refPtrConst_calledOnceWithCorrectValue()</div>
<div class="line">    {</div>
<div class="line">        InHelper helper(m_lua);</div>
<div class="line">        EXPECT_CALL(helper.mock, refPtrConst(::testing::Eq(helper.inputParam_ptrConst))).Times(1);</div>
<div class="line">        helper.run_method();</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(1, helper.object, <span class="stringliteral">&quot;refPtrConst&quot;</span>, helper.inputParam_ptrConst);</div>
<div class="line">    }</div>
</div><!-- fragment --><h3><a class="anchor" id="OOLuaTraitOutDoc"></a>
out_p</h3>
<p>The calling Lua procedure does not pass the parameter to the proxied function, instead one is created using the default constructor and passed to the proxied function. The result after the proxied call with be returned to the calling procedure. If this is a type which has a proxy then it will cause a heap allocation of the type, which Lua will own. </p>
<p>Member Function: </p>
<div class="fragment"><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> refPtr(ParamType*&amp; instance) = 0;</div>
</div><!-- fragment --><p> Proxy Function: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga263ff9ad508c44c25b2c09283831f8a4" title="Generates a member function proxy which will be the named ProxyFunctionName. ">OOLUA_MEM_FUNC_RENAME</a>(outTraitRefPtr, <span class="keywordtype">void</span>, refPtr, out_p&lt;HasIntMember*&amp;&gt;)</div>
</div><!-- fragment --><p> Usage: </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> OutTraitRefPtr_luaPassesNoParam_topOfStackIsOwnedByLua()</div>
<div class="line">    {</div>
<div class="line">        ::testing::NiceMock&lt;OutParamUserDataMock&gt; stub;</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;return function(obj) return obj:outTraitRefPtr() end&quot;</span>);</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(1, static_cast&lt;OutParamUserData*&gt;(&amp;stub));</div>
<div class="line">        OOLUA::INTERNAL::Lua_ud * ud = <span class="keyword">static_cast&lt;</span>OOLUA::INTERNAL::Lua_ud *<span class="keyword">&gt;</span>(lua_touserdata(*m_lua, -1));</div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(<span class="keyword">true</span>, OOLUA::INTERNAL::userdata_is_to_be_gced(ud));</div>
<div class="line">    }</div>
</div><!-- fragment --><h3><a class="anchor" id="OOLuaTraitInOutDoc"></a>
in_out_p</h3>
<p>The calling Lua procedure supplies the parameter to the proxied function, the value of the parameter after the proxied call will be passed back to the calling procedure as a return value. No change of ownership occurs. </p>
<p>Member Function: </p>
<div class="fragment"><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> ref(ParamType&amp; instance)=0;</div>
</div><!-- fragment --><p> Proxy Function: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9" title="Generates a member function proxy which will also be the named FunctionName. ">OOLUA_MEM_FUNC</a>(<span class="keywordtype">void</span>, ref, in_out_p&lt;int&amp;&gt;)</div>
</div><!-- fragment --><p> Usage: </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> inOutTraitRef_luaPassesIntCppAssignsNewValue_returnIsNewlyAssignedValue()</div>
<div class="line">    {</div>
<div class="line">        InOutParamHelper helper(m_lua);</div>
<div class="line">        EXPECT_CALL(helper.mock, ref(::testing::_)).Times(1).WillOnce(::testing::SetArgReferee&lt;0&gt;(helper.expected));</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;return function(object) return object:ref(1) end&quot;</span>);</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(1, helper.object);</div>
<div class="line">        assert_top_of_stack_is_expected_value(helper.expected);</div>
<div class="line">    }</div>
</div><!-- fragment --><h3><a class="anchor" id="OOLuaTraitLuaOutDoc"></a>
lua_out_p</h3>
<p>Lua code does not pass an instance to the C++ function, yet the pushed back value after the function call will be owned by Lua. This is meaningful only if called with a type which has a proxy and it is by reference, otherwise undefined. </p>
<p>Member Function: </p>
<div class="fragment"><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> refPtr(ParamType*&amp; instance) = 0;</div>
</div><!-- fragment --><p> Proxy Function: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga263ff9ad508c44c25b2c09283831f8a4" title="Generates a member function proxy which will be the named ProxyFunctionName. ">OOLUA_MEM_FUNC_RENAME</a>(lua_takes_ownership_of_ref_2_ptr</div>
<div class="line">                        , <span class="keywordtype">void</span>, refPtr, lua_out_p&lt;Stub1*&amp;&gt;)</div>
</div><!-- fragment --><p> Usage: </p>
<div class="fragment"><div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a870cd14a0757100bafcd5e4352894e83" title="Helper function. ">register_class</a>&lt;OwnershipParamUserData&gt;();</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;return function(object) return object:lua_takes_ownership_of_ref_2_ptr() end&quot;</span>);</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(1, <span class="keywordtype">object</span>);</div>
<div class="line">        <span class="comment">//there is now a proxy type on top of the stack which Lua owns</span></div>
</div><!-- fragment --><h3><a class="anchor" id="OOLuaTraitCppInDoc"></a>
cpp_in_p</h3>
<p>Parameter supplied via Lua changes ownership to C++. </p>
<p>Member Function: </p>
<div class="fragment"><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> ptr(ParamType* instance) = 0;</div>
</div><!-- fragment --><p> Proxy Function: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga263ff9ad508c44c25b2c09283831f8a4" title="Generates a member function proxy which will be the named ProxyFunctionName. ">OOLUA_MEM_FUNC_RENAME</a>(cpp_takes_ownership_of_ptr_param</div>
<div class="line">                        , <span class="keywordtype">void</span>, ptr, cpp_in_p&lt;Stub1*&gt;)</div>
</div><!-- fragment --><p> Usage: </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> cppInP_ptr2UserDataType_passingPtrThatLuaOwns_topOfStackGcIsFalse()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">bool</span> result = returnGarbageCollectValueAfterCppTakingOwnership(</div>
<div class="line">                         <span class="stringliteral">&quot;cpp_takes_ownership_of_ptr_param&quot;</span>);</div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(<span class="keyword">false</span>, result);</div>
<div class="line">    }</div>
</div><!-- fragment --><h3><a class="anchor" id="OOLuaTraitLightPDoc"></a>
light_p</h3>
<p>The calling Lua procedure supplies a LUA_TLIGHTUSERDATA which will be cast to the requested T type. If T is not the correct type for the light userdata then the casting is undefined. A light userdata is never owned by Lua </p>
<p>Member Function: </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> value(<span class="keywordtype">void</span>* void_ptr);</div>
</div><!-- fragment --><p> Proxy Function: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9" title="Generates a member function proxy which will also be the named FunctionName. ">OOLUA_MEM_FUNC</a>(<span class="keywordtype">void</span>, value, light_p&lt;void*&gt;)</div>
</div><!-- fragment --><p> Usage: </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> functionParam_functionWhichTakesVoidPointer_functionIsCalledWithTheCorrectValue()</div>
<div class="line">    {</div>
<div class="line">        LightParamUserDataMock mock;</div>
<div class="line">        LightParamUserData* <span class="keywordtype">object</span> = &amp;mock;</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a870cd14a0757100bafcd5e4352894e83" title="Helper function. ">register_class</a>&lt;LightParamUserData&gt;();</div>
<div class="line">        <span class="keywordtype">int</span> i(0);</div>
<div class="line">        <span class="keywordtype">void</span>* input_ud = &amp;i;</div>
<div class="line">        EXPECT_CALL(mock, value(::testing::Eq(input_ud))).Times(1);</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;return function(object,param) return object:value(param) end&quot;</span>);</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(1, <span class="keywordtype">object</span>, input_ud);</div>
<div class="line">    }</div>
</div><!-- fragment --> <p>or </p>
<p>Member Function: </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> ptr(InvalidStub* data);</div>
</div><!-- fragment --><p> Proxy Function: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9" title="Generates a member function proxy which will also be the named FunctionName. ">OOLUA_MEM_FUNC</a>(<span class="keywordtype">void</span>, ptr, light_p&lt;InvalidStub*&gt;)</div>
</div><!-- fragment --><p> Usage: </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> functionParam_functionWhichTakesNoneVoidPointer_functionIsCalledWithTheCorrectValue()</div>
<div class="line">    {</div>
<div class="line">        LightNoneVoidParamUserDataMock mock;</div>
<div class="line">        LightNoneVoidParamUserData* <span class="keywordtype">object</span> = &amp;mock;</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a870cd14a0757100bafcd5e4352894e83" title="Helper function. ">register_class</a>&lt;LightNoneVoidParamUserData&gt;();</div>
<div class="line">        InvalidStub lightud;</div>
<div class="line">        <span class="keywordtype">void</span>* lightud_ptr = &amp;lightud;</div>
<div class="line">        EXPECT_CALL(mock, ptr(::testing::Eq(lightud_ptr))).Times(1);</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;return function(object,param) return object:ptr(param) end&quot;</span>);</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(1, <span class="keywordtype">object</span>, lightud_ptr);</div>
<div class="line">    }</div>
</div><!-- fragment --><h3><a class="anchor" id="OOLuaTraitCallingLuaState"></a>
calling_lua_state</h3>
<p>This is different from all other traits as it does not take a type, yet is a type. It informs OOLua that the calling state is a parameter for a function </p>
<p>Member Function: </p>
<div class="fragment"><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> value(ParamType instance) = 0;</div>
</div><!-- fragment --><p> Proxy Function: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9" title="Generates a member function proxy which will also be the named FunctionName. ">OOLUA_MEM_FUNC</a>(<span class="keywordtype">void</span>, value, calling_lua_state)</div>
</div><!-- fragment --><p> Usage: </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> callingLuaState_luaPassesNoParameterYetFunctionWantsALuaInstance_calledOnceWithCorrectInstance()</div>
<div class="line">    {</div>
<div class="line">        LuaStateParamMock mock;</div>
<div class="line">        <a class="code" href="structlua___state.html" title="Lua virtual machine. ">lua_State</a>* vm = *m_lua;</div>
<div class="line">        EXPECT_CALL(mock, value(::testing::Eq(vm))).Times(1);</div>
<div class="line"></div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a870cd14a0757100bafcd5e4352894e83" title="Helper function. ">register_class</a>&lt;LuaStateParam&gt;();</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;return function(object) object:value() end&quot;</span>);</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(1, static_cast&lt;LuaStateParam*&gt;(&amp;mock));</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="OOLuaFunctionReturnTraitsDoc"></a>
Function Return Traits</h2>
<p>DSL traits for function return types. </p>
<p>Some of the these traits allow for NULL pointers to be returned from functions, which was something commonly requested for the library. When such a trait is used and the runtime value is NULL, Lua's value of nil will be pushed to the stack. </p>
<h3><a class="anchor" id="OOLuaLuaReturnTrait"></a>
lua_return</h3>
<p>The type returned from the function is a heap allocated instance whose ownership will be controlled by Lua. This is only valid for function return types. </p>
<p>Member Function: </p>
<div class="fragment"><div class="line">    <span class="keyword">virtual</span> ReturnType* ptr() = 0;</div>
</div><!-- fragment --><p> Proxy Function: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9" title="Generates a member function proxy which will also be the named FunctionName. ">OOLUA_MEM_FUNC</a>(lua_return&lt;Stub1*&gt;, ptr)</div>
</div><!-- fragment --><p> Usage: </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> luaReturnTrait_callsMethodPtr_returnValueIsToBeGarbageCollected()</div>
<div class="line">    {</div>
<div class="line">        ReturnTraitHelper helper(m_lua);</div>
<div class="line">        EXPECT_CALL(helper.mock, ptr()).Times(1).WillOnce(::testing::Return(&amp;helper.return_stub));</div>
<div class="line">        helper.call_object_method(<span class="stringliteral">&quot;ptr&quot;</span>);</div>
<div class="line">        assert_that_tops_gc_flag_is(<span class="keyword">true</span>);</div>
<div class="line">        set_tops_gc_flag_to(<span class="keyword">false</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><h3><a class="anchor" id="OOLuaMaybeNullTrait"></a>
maybe_null</h3>
<p>The type returned from the function is a pointer instance whose runtime value maybe NULL. If it is NULL then lua_pushnil will be called else the pointer will be pushed as normal. No change of ownership will occur for the type. This is only valid for function return types. </p>
<dl class="section note"><dt>Note</dt><dd>To be consistent in naming this should really be called maybe_null_return, however I feel this would be too long a name for the trait so "return" has been dropped. </dd></dl>
<p>Member Function: </p>
<div class="fragment"><div class="line">    <span class="keyword">virtual</span> ReturnType * <span class="keyword">const</span> constPtr() = 0;</div>
</div><!-- fragment --><p> Proxy Function: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9" title="Generates a member function proxy which will also be the named FunctionName. ">OOLUA_MEM_FUNC</a>(maybe_null&lt;Stub1*&gt;, ptr)</div>
</div><!-- fragment --><p> Usage: </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> maybeNullTrait_callsMethodConstPtrWhichReturnsNull_stackTopIsNil()</div>
<div class="line">    {</div>
<div class="line">        MaybeNullTraitHelper helper(m_lua);</div>
<div class="line">        EXPECT_CALL(helper.mock, constPtr()).Times(1).WillOnce(::testing::Return(static_cast&lt;Stub1 *const&gt;(NULL)));</div>
<div class="line">        helper.call_object_method(<span class="stringliteral">&quot;constPtr&quot;</span>);</div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(LUA_TNIL, lua_type(*m_lua, -1));</div>
<div class="line">    }</div>
</div><!-- fragment --><h3><a class="anchor" id="OOLuaLuaMaybeNullTrait"></a>
lua_maybe_null</h3>
<p>The type returned from the function is a pointer instance whose runtime value maybe NULL. If it is NULL then lua_pushnil will be called else the pointer will be pushed and transfer ownership of the instance to Lua. This is only valid for function return types. </p>
<dl class="section note"><dt>Note</dt><dd>To be consistent in naming this should really be called lua_maybe_null_return, however I feel this would be too long a name for the trait so "return" has been dropped. </dd></dl>
<p>Member Function: </p>
<div class="fragment"><div class="line">    <span class="keyword">virtual</span> ReturnType* ptr() = 0;</div>
</div><!-- fragment --><p> Proxy Function: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9" title="Generates a member function proxy which will also be the named FunctionName. ">OOLUA_MEM_FUNC</a>(lua_maybe_null&lt;Stub1*&gt;, ptr)</div>
</div><!-- fragment --><p> Usage: </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> luaMaybeNullTrait_callsMethodPtrWhichReturnsValidPtr_stackTopGcValueIsTrue()</div>
<div class="line">    {</div>
<div class="line">        LuaMaybeNullTraitHelper helper(m_lua);</div>
<div class="line">        EXPECT_CALL(helper.mock, ptr()).Times(1).WillOnce(::testing::Return(&amp;helper.return_stub));</div>
<div class="line">        helper.call_object_method(<span class="stringliteral">&quot;ptr&quot;</span>);</div>
<div class="line">        assert_that_tops_gc_flag_is(<span class="keyword">true</span>);</div>
<div class="line">        set_tops_gc_flag_to(<span class="keyword">false</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><h3><a class="anchor" id="OOLuaLightReturnTraits"></a>
light_return</h3>
<p>The type returned from the function is either a void pointer or a pointer to another type. When the function returns, it will push a LUA_TLIGHTUSERDATA to the stack even when the pointer is NULL; therefore a NULL pointer using this traits is never converted to a Lua nil value. A light userdata is also never owned by Lua and OOLua does not store any type information for the it; light_return is a black box which when used incorrectly will invoke undefined behaviour.<br/>
 This is only valid for function return types. </p>
<p>Void pointer: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9" title="Generates a member function proxy which will also be the named FunctionName. ">OOLUA_MEM_FUNC</a>(light_return&lt;void*&gt;, value)</div>
</div><!-- fragment --><p> None void pointer: </p>
<div class="fragment"><div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9" title="Generates a member function proxy which will also be the named FunctionName. ">OOLUA_MEM_FUNC</a>(light_return&lt;InvalidStub*&gt;, ptr)</div>
</div><!-- fragment --> <h2><a class="anchor" id="OOLuaStackTraitsDoc"></a>
Stack Traits</h2>
<p>Public API traits which control a change of ownership. </p>
<p>Valid to usage for the Public API which interact with the Lua stack. </p>
<h3><a class="anchor" id="OOLuaTraitCppAcquirePtr"></a>
cpp_acquire_ptr</h3>
<p>Informs the library that C++ will take control of the pointer being used and call delete on it when appropriate. This is only valid for public API functions which <a class="el" href="namespace_o_o_l_u_a.html#a16e0b11358d3e36facfdf294eab8f1b7">OOLUA::pull</a> from the stack. </p>
<div class="fragment"><div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;return Stub1.new()&quot;</span>);</div>
<div class="line">        <a class="code" href="struct_o_o_l_u_a_1_1cpp__acquire__ptr.html" title="Change of ownership to C++. ">OOLUA::cpp_acquire_ptr&lt;Stub1*&gt;</a> res;</div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a16e0b11358d3e36facfdf294eab8f1b7" title="Pulls the top element off the stack and pops it. ">OOLUA::pull</a>(*m_lua, res);</div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(<span class="keyword">true</span>, res.m_ptr != 0);</div>
<div class="line">        <span class="keyword">delete</span> res.m_ptr;</div>
</div><!-- fragment --><h3><a class="anchor" id="OOLuaTraitLuaAcquirePtr"></a>
lua_acquire_ptr</h3>
<p>Informs the library that Lua will take control of the pointer being used and call delete on it when appropriate. This is only valid for public API functions which <a class="el" href="namespace_o_o_l_u_a.html#a52ee8bb21b16b5c71afad4bd8e616485">OOLUA::push</a> to the stack. </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> callFunction_passingPointerUsingLuaAcquirePtr_topOfStackGcIsTrue()</div>
<div class="line">    {</div>
<div class="line">        Stub1 stub;</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;foo = function(param) return param end&quot;</span>);</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(<span class="stringliteral">&quot;foo&quot;</span>, <a class="code" href="struct_o_o_l_u_a_1_1lua__acquire__ptr.html" title="Change of ownership to Lua. ">OOLUA::lua_acquire_ptr&lt;Stub1*&gt;</a>(&amp;stub));</div>
<div class="line">        OOLUA::INTERNAL::Lua_ud * ud = get_ud_helper();</div>
<div class="line">        <span class="keywordtype">bool</span> gc_value = OOLUA::INTERNAL::userdata_is_to_be_gced(ud);</div>
<div class="line">        OOLUA::INTERNAL::userdata_gc_value(ud, <span class="keyword">false</span>);</div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(<span class="keyword">true</span>, gc_value);</div>
<div class="line">    }</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Here we use the public API function <a class="el" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">OOLUA::Script::call</a> which uses <a class="el" href="namespace_o_o_l_u_a.html#a52ee8bb21b16b5c71afad4bd8e616485">OOLUA::push</a></dd></dl>
<h2><a class="anchor" id="OOLuaTraitReturnOrder"></a>
Return Order</h2>
<p>Lua supports multiple return values for functions ( return = [explist] ). The order of returns in the stack is shown in the following example, simply the first will be pushed to the top of the stack, then the second to the top. This continues until all returns have been pushed on to the stack and the final return is located at the top. </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> luaReturnOrder_luaFunctionWhichReturnsMultipleValuesToCpp_orderFromTopOfStackIsInput2Input1()</div>
<div class="line">    {</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#a90a3d026d4e00bca54c59280e38557d9" title="Helper function. ">run_chunk</a>(<span class="stringliteral">&quot;return function(input1, input2) return input1, input2 end &quot;</span>);</div>
<div class="line">        <span class="keywordtype">int</span> input1(1);</div>
<div class="line">        <span class="keywordtype">int</span> input2(2);</div>
<div class="line"></div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(1, input1, input2);</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">          ========</span></div>
<div class="line"><span class="comment">         | input2 | &lt;-- stack top</span></div>
<div class="line"><span class="comment">          ========</span></div>
<div class="line"><span class="comment">         | input1 |</span></div>
<div class="line"><span class="comment">          ========</span></div>
<div class="line"><span class="comment">         |   ...  |</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordtype">int</span> topOfStack, nextSlot;</div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a16e0b11358d3e36facfdf294eab8f1b7" title="Pulls the top element off the stack and pops it. ">OOLUA::pull</a>(*m_lua, topOfStack);</div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a16e0b11358d3e36facfdf294eab8f1b7" title="Pulls the top element off the stack and pops it. ">OOLUA::pull</a>(*m_lua, nextSlot);</div>
<div class="line"></div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(input2, topOfStack);</div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(input1, nextSlot);</div>
<div class="line">    }</div>
</div><!-- fragment --><p> C++ in a way also supports multiple returns via references. Here we have a C++ member function which returns an int, the function also assigns a new value to the parameter which is taken by reference. </p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="struct_return_order.html">ReturnOrder</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">enum</span> {returnValue=-1, paramValue};</div>
<div class="line">    <span class="keywordtype">int</span> foo(<span class="keywordtype">int</span>&amp; bar)</div>
<div class="line">    {</div>
<div class="line">        bar = paramValue;</div>
<div class="line">        <span class="keywordflow">return</span> returnValue;</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><p> In effect this function has two return values so one way we could proxy the function and detail that information would be using the <a class="el" href="group___o_o_lua_expressive.html">Expressive</a> DSL macro <a class="el" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9">OOLUA_MEM_FUNC</a> and applying an <a class="el" href="struct_o_o_l_u_a_1_1in__out__p.html">in_out_p</a> trait to the parameter. </p>
<div class="fragment"><div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga7941d8799929590eace6acdeec68f7dd" title="Starts the generation a proxy class. ">OOLUA_PROXY</a>(<a class="code" href="struct_return_order.html">ReturnOrder</a>)</div>
<div class="line">    <a class="code" href="group___o_o_lua_expressive.html#ga63b334c4b6ee82dd4a1497a6c6bb65e9" title="Generates a member function proxy which will also be the named FunctionName. ">OOLUA_MEM_FUNC</a>(<span class="keywordtype">int</span>, foo, in_out_p&lt;<span class="keywordtype">int</span>&amp;&gt;)</div>
<div class="line"><a class="code" href="group___o_o_lua_d_s_l.html#ga8dccd4d1893d0352a0f5e486c527c49e" title="Ends the generation of the proxy class. ">OOLUA_PROXY_END</a></div>
</div><!-- fragment --> <p>After calling this function there will be two returned values; the return of the C++ function and the value of the parameter after the call. The top of stack will contain the furthest right handside parameter which had an out trait, which in this case there was only one, below this will be proceeding parameters which had out traits and then the return value in that order. </p>
<div class="fragment"><div class="line">    <span class="keywordtype">void</span> ordering_functionWhichReturnsValueAndTwoInOutParams_orderFromTopOfStackIsParam2Param1Return()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span> input1(OutParamsTest::Dummy);</div>
<div class="line">        <span class="keywordtype">int</span> input2(OutParamsTest::Dummy);</div>
<div class="line">        run_chunk_function_push_two_ints(<span class="stringliteral">&quot;return_int_and_2_int_refs&quot;</span>, input1, input2, <span class="keyword">true</span>);</div>
<div class="line">        ::testing::NiceMock&lt;MockOutParamsTest&gt; stub;</div>
<div class="line">        m_lua-&gt;<a class="code" href="class_o_o_l_u_a_1_1_script.html#aeb72eac1a7a2ca5f9d4292e5a7fe7623">call</a>(<span class="stringliteral">&quot;func&quot;</span>, static_cast&lt;OutParamsTest*&gt;(&amp;stub));</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> r1, r2, r3;</div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a16e0b11358d3e36facfdf294eab8f1b7" title="Pulls the top element off the stack and pops it. ">OOLUA::pull</a>(*m_lua, r1);<span class="comment">//top of stack</span></div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a16e0b11358d3e36facfdf294eab8f1b7" title="Pulls the top element off the stack and pops it. ">OOLUA::pull</a>(*m_lua, r2);</div>
<div class="line">        <a class="code" href="namespace_o_o_l_u_a.html#a16e0b11358d3e36facfdf294eab8f1b7" title="Pulls the top element off the stack and pops it. ">OOLUA::pull</a>(*m_lua, r3);</div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(static_cast&lt;int&gt;(OutParamsTest::Param2), r1);</div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(static_cast&lt;int&gt;(OutParamsTest::Param1), r2);</div>
<div class="line">        CPPUNIT_ASSERT_EQUAL(static_cast&lt;int&gt;(OutParamsTest::Return), r3);</div>
<div class="line">    }</div>
</div><!-- fragment -->  
            <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
            <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
             Are you a bottom up kind of person? <br/>
 The return value is on the bottom of the stack (Lua stack index 1) with parameter one at index 2.<br/>
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="_o_o_lua_useage.html">Usage</a></li>
    <li class="footer">Generated on Sun Oct 27 2013 14:01:54 for OOLua by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
